(()=>{"use strict";const e=(e,t)=>{let s=[],o=parseInt(e[0],10),c=parseInt(e[1],10);console.log(typeof o,`${o}`,"testing type of x "),console.log(typeof c,`${c}`,"testing type of y ");let r=t.squares[o][c];return console.log(r,"testing board values"),{knight:function(){if(o+1<=7&&c+2<=7){const e=o+1,a=c+2;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(o+2<=7&&c+1<=7){const e=o+2,a=c+1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(c+2<=7&&o-1>=0){const e=o-1,a=c+2;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(c+1<=7&&o-2>=0){const e=o-2,a=c+1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(o+1<=7&&c-2>=0){const e=o+1,a=c-2;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(o+2<=7&&c-1>=0){const e=o+2,a=c-1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(o-2>=0&&c-1>=0){const e=o-2,a=c-1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(o-1>=0&&c-2>=0){const e=o-1,a=c-2;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}},king:function(){if(console.log("I happened 1"),r.start&&void 0!==t.squares[o+3][c]&&t.squares[o+3][c].start&&void 0===t.squares[o+1][c]&&void 0===t.squares[o+2][c]&&s.push([o+2,c]),console.log("I happened 2"),r.start&&void 0!==t.squares[o-4][c]&&t.squares[o-4][c].start&&void 0===t.squares[o-1][c]&&void 0===t.squares[o-2][c]&&void 0===t.squares[o-3][c]&&s.push([o-2,c]),console.log("I happened 3"),o+1<=7){const e=o+1,a=c;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(o+1<=7&&c+1<=7){const e=o+1,a=c+1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(o+1<=7&&c-1>=0){const e=o+1,a=c-1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(o-1>=0){const e=o-1,a=c;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(o-1>=0&&c+1<=7){const e=o-1,a=c+1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(o-1>=0&&c-1>=0){const e=o-1,a=c-1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(c+1<=7){const e=o,a=c+1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}if(c-1>=0){const e=o,a=c-1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&s.push([e,a])}},rook:function(){let e=1;for(;o+e<=7;)void 0===t.squares[o+e][c]?(s.push([o+e,c]),e++):(r.color===t.squares[o+e][c].color||s.push([o+e,c]),e=8);for(e=1;c+e<=7;)void 0===t.squares[o][c+e]?(s.push([o,c+e]),e++):(r.color===t.squares[o][c+e].color||s.push([o,c+e]),e=8);for(e=1;o-e>=0;)void 0===t.squares[o-e][c]?(s.push([o-e,c]),e++):(r.color===t.squares[o-e][c].color||s.push([o-e,c]),e=8);for(e=1;c-e>=0;)void 0===t.squares[o][c-e]?(s.push([o,c-e]),e++):(r.color===t.squares[o][c-e].color||s.push([o,c-e]),e=8)},bishop:function(){let e=1;for(;o+e<=7&&c+e<=7;){let a=o+e,i=c+e;void 0===t.squares[a][i]?(e++,s.push([a,i])):(t.squares[a][i].color===r.color||s.push([a,i]),e=8)}for(e=1;o+e<=7&&c-e>=0;){let a=o+e,i=c-e;void 0===t.squares[a][i]?(e++,s.push([a,i])):(t.squares[a][i].color===r.color||s.push([a,i]),e=8)}for(e=1;o-e>=0&&c+e<=7;){let a=o-e,i=c+e;void 0===t.squares[a][i]?(e++,s.push([a,i])):(t.squares[a][i].color===r.color||s.push([a,i]),e=8)}for(e=1;o-e>=0&&c-e>=0;){let a=o-e,i=c-e;void 0===t.squares[a][i]?(s.push([a,i]),e++):(t.squares[a][i].color===r.color||s.push([a,i]),e=8)}},queen:function(){this.rook(),this.bishop()},pawn:function(){"white"===r.color?(console.log("I happened"),o+1<=7&&void 0!==t.squares[o+1][c]&&t.squares[o+1][c].enpasant&&t.squares[o+1][c].color!==r.color&&s.push([o+1,c+1]),console.log("I happened 2"),o-1>=0&&void 0!==t.squares[o-1][c]&&t.squares[o-1][c].enpasant&&t.squares[o-1][c].color!==r.color&&s.push([o-1,c+1]),console.log("I happened 3"),c+2<=7&&r.start&&void 0===t.squares[o][c+1]&&void 0===t.squares[o][c+2]&&s.push([o,c+2]),console.log("I happened 4"),c+1<=7&&void 0===t.squares[o][c+1]&&(s.push([o,c+1]),console.log("I happened 5")),o+1<=7&&c+1<=7&&void 0!==t.squares[o+1][c+1]&&"white"!==t.squares[o+1][c+1].color&&s.push([o+1,c+1]),console.log("I happened 6"),o-1>=0&&c+1<=7&&void 0!==t.squares[o-1][c+1]&&"white"!==t.squares[o-1][c+1].color&&s.push([o-1,c+1]),console.log("Sucess")):(console.log("I happened"),o+1<=7&&void 0!==t.squares[o+1][c]&&t.squares[o+1][c].enpasant&&t.squares[o+1][c].color!==r.color&&s.push([o+1,c-1]),console.log("I happened 2"),o-1>=0&&void 0!==t.squares[o-1][c]&&t.squares[o-1][c].enpasant&&t.squares[o-1][c].color!==r.color&&s.push([o-1,c-1]),console.log("I happened 3"),c-2>=0&&r.start&&void 0===t.squares[o][c-1]&&void 0===t.squares[o][c-2]&&s.push([o,c-2]),console.log("I happened 4"),c-1>=0&&void 0===t.squares[o][c-1]&&(s.push([o,c-1]),console.log("I happened 5")),o+1<=7&&c-1>=0&&void 0!==t.squares[o+1][c-1]&&"black"!==t.squares[o+1][c-1].color&&s.push([o+1,c-1]),console.log("I happened 6"),o-1>=0&&c-1>=0&&void 0!==t.squares[o-1][c-1]&&"black"!==t.squares[o-1][c-1].color&&s.push([o-1,c-1]),console.log("Sucess"))}}[r.type](),s},t=()=>{let t=(()=>{let e=[new Array(8),new Array(8),new Array(8),new Array(8),new Array(8),new Array(8),new Array(8),new Array(8)];return{playerFactory:e=>{const t={};return t.color=e,t.human=!1,t.king=!0,t},pieceFactory:(e,t)=>{const s={};return s.color=t,s.type=e,s.img=`../public/images/pieces/${t} ${e}.png`,s},squares:e,setPieceTo:(t,s,o,c)=>{t.start=!1,c&&(t.start=!0),e[s][o]=t}}})(),s=t.squares;const o=()=>{let e=!1;document.querySelector("#boardSquares").innerHTML="",s.forEach(((t,s)=>{let o=document.createElement("tr");o.setAttribute("class","tableRow");for(let c=0;c<=7;c++){let r=document.createElement("td");r.setAttribute("class","boardSquare"),r.setAttribute("data-coords",`${s}${c}`);let a=t[c];if(void 0!==a){let e=document.createElement("img");e.setAttribute("class","pieceImg"),e.setAttribute("src",a.img),e.setAttribute("alt",`${a.color} ${a.type}`),r.setAttribute(`data-${a.color}`,""),r.appendChild(e)}!0===e?(e=!1,r.classList.add("green")):e=!0,o.appendChild(r)}e=!0!==e,document.getElementById("boardSquares").appendChild(o)}))},c=e=>{document.querySelectorAll(`[data-${e}]`).forEach((e=>{e.addEventListener("click",r),e.classList.add("active")}))},r=s=>{l(),s.target.setAttribute("id","clickedPiece");const o=e(s.target.dataset.coords,t);a(o)},a=e=>{e.forEach((e=>{let t=document.createElement("div");t.classList.add("grey");let s=document.querySelector(`[data-coords="${e[0]}${e[1]}"]`);s.classList.add("possibleMove"),s.appendChild(t),s.addEventListener("click",i)}))},i=e=>{let r=document.querySelector("#clickedPiece"),a=parseInt(r.dataset.coords[0],10),i=parseInt(r.dataset.coords[1],10),n=parseInt(e.target.dataset.coords[0],10),d=parseInt(e.target.dataset.coords[1],10);console.log("I happened"),"pawn"===s[a][i].type&&(s[a][i].enpasant=!1,d-i==2||i-d==2?s[a][i].enpasant=!0:a!==n&&void 0===s[n][d]&&(s[n][i]=void 0)),"king"===s[a][i].type&&s[a][i].start&&(n-a==2?(t.setPieceTo(s[n+1][i],n-1,i),s[n+1][i]=void 0):n-a==-2&&(t.setPieceTo(s[n-2][i],n+1,i),s[n-2][i]=void 0)),t.setPieceTo(s[a][i],n,d),console.log("I happened 2"),s[a][i]=void 0,console.log("I happened 3"),l(),o(),c(s[n][d].color),"pawn"===s[n][d].type&&(7===d&&u.white(n,d),0===d&&u.black(n,d))},l=()=>{let e=document.querySelector("#clickedPiece");null!==e&&e.removeAttribute("id"),document.querySelectorAll(".grey").forEach((e=>{let t=e.parentElement;t.classList.remove("possibleMove"),t.removeEventListener("click",i),t.removeChild(e)}))},n=e=>{document.querySelectorAll(`[data-${e}]`).forEach((e=>{console.log("item removed sucessfully"),e.removeEventListener("click",r),e.classList.remove("active")}))},u={white:function(e,c){n("white");let r=document.querySelector(`[data-coords="${e}${c}"]`),a=document.createElement("div");a.classList.add("promoting");let i=document.createElement("img");i.setAttribute("src","../public/images/pieces/white queen.png"),i.setAttribute("alt","promote to queen"),i.addEventListener("click",(r=>{s[e][c]=t.pieceFactory("queen","white"),o()})),i.classList.add("active");let l=document.createElement("img");l.setAttribute("src","../public/images/pieces/white knight.png"),l.setAttribute("alt","promote to knight"),l.addEventListener("click",(()=>{s[e][c]=t.pieceFactory("knight","white"),o()})),l.classList.add("active");let u=document.createElement("img");u.setAttribute("src","../public/images/pieces/white rook.png"),u.setAttribute("alt","promote to rook"),u.addEventListener("click",(()=>{s[e][c]=t.pieceFactory("rook","white"),o()})),u.classList.add("active");let d=document.createElement("img");d.setAttribute("src","../public/images/pieces/white bishop.png"),d.setAttribute("alt","promote to bishop"),d.addEventListener("click",(()=>{s[e][c]=t.pieceFactory("bishop","white"),o()})),d.classList.add("active");let p=document.createElement("img");p.setAttribute("src","../public/images/pieces/white pawn.png"),p.setAttribute("alt","promote to pawn"),p.addEventListener("click",(()=>{o()})),p.classList.add("active"),a.appendChild(i),a.appendChild(l),a.appendChild(u),a.appendChild(d),a.appendChild(p),r.appendChild(a)},black:function(e,c){n("black");let r=document.querySelector(`[data-coords="${e}${c}"]`),a=document.createElement("div");a.classList.add("promoting");let i=document.createElement("img");i.setAttribute("src","../public/images/pieces/black queen.png"),i.setAttribute("alt","promote to queen"),i.addEventListener("click",(r=>{s[e][c]=t.pieceFactory("queen","black"),o()})),i.classList.add("active");let l=document.createElement("img");l.setAttribute("src","../public/images/pieces/black knight.png"),l.setAttribute("alt","promote to knight"),l.addEventListener("click",(()=>{s[e][c]=t.pieceFactory("knight","black"),o()})),l.classList.add("active");let u=document.createElement("img");u.setAttribute("src","../public/images/pieces/black rook.png"),u.setAttribute("alt","promote to rook"),u.addEventListener("click",(()=>{s[e][c]=t.pieceFactory("rook","black"),o()})),u.classList.add("active");let d=document.createElement("img");d.setAttribute("src","../public/images/pieces/black bishop.png"),d.setAttribute("alt","promote to bishop"),d.addEventListener("click",(()=>{s[e][c]=t.pieceFactory("bishop","black"),o()})),d.classList.add("active");let p=document.createElement("img");p.setAttribute("src","../public/images/pieces/black pawn.png"),p.setAttribute("alt","promote to pawn"),p.addEventListener("click",(()=>{o()})),p.classList.add("active"),a.appendChild(i),a.appendChild(l),a.appendChild(u),a.appendChild(d),a.appendChild(p),r.appendChild(a)}};return{placePieces:()=>{for(let e=0;e<=7;e++)t.setPieceTo(t.pieceFactory("pawn","white"),e,1,!0);for(let e=0;e<=7;e++)t.setPieceTo(t.pieceFactory("pawn","black"),e,6,!0);t.setPieceTo(t.pieceFactory("rook","white"),0,0,!0),t.setPieceTo(t.pieceFactory("rook","white"),7,0,!0),t.setPieceTo(t.pieceFactory("rook","black"),0,7,!0),t.setPieceTo(t.pieceFactory("rook","black"),7,7,!0),t.setPieceTo(t.pieceFactory("knight","white"),1,0),t.setPieceTo(t.pieceFactory("knight","white"),6,0),t.setPieceTo(t.pieceFactory("knight","black"),1,7),t.setPieceTo(t.pieceFactory("knight","black"),6,7),t.setPieceTo(t.pieceFactory("bishop","white"),2,0),t.setPieceTo(t.pieceFactory("bishop","white"),5,0),t.setPieceTo(t.pieceFactory("bishop","black"),2,7),t.setPieceTo(t.pieceFactory("bishop","black"),5,7),t.setPieceTo(t.pieceFactory("queen","white"),3,0),t.setPieceTo(t.pieceFactory("queen","black"),3,7),t.setPieceTo(t.pieceFactory("king","white"),4,0,!0),t.setPieceTo(t.pieceFactory("king","black"),4,7,!0)},renderBoard:o,chooseSide:e=>{let s=t.playerFactory("white"),o=t.playerFactory("black");return"1"===e?s.human=!0:o.human=!0,{player1:s,player2:o}},playerCanClick:c,game:t}};function s(e){document.querySelector(".pages .page.active").classList.remove("active"),document.querySelector(`.pages .page[data-page="${e}"]`).classList.add("active")}function o(e){let s=t();s.placePieces(),s.renderBoard(),console.log("testing gameboard 0 0 "),document.getElementById("sidechoice").classList.add("hide"),s.chooseSide(e.target.attributes.value.value).player1.human?s.playerCanClick("white"):s.playerCanClick("black")}window.onload=()=>{const e=document.querySelectorAll("[data-switcher]");for(let t=0;t<e.length;t++){const o=e[t],c=o.dataset.tab;o.addEventListener("click",(()=>{document.querySelector(".tabs .tab.active").classList.remove("active"),o.parentNode.classList.add("active"),s(c)}))}},document.getElementById("whitecolor").addEventListener("click",(e=>{o(e)})),document.getElementById("blackcolor").addEventListener("click",(e=>{o(e)}))})();