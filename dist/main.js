(()=>{"use strict";const e=(e,o)=>{let s=[],t=parseInt(e[0],10),r=parseInt(e[1],10);console.log(typeof t,`${t}`,"testing type of x "),console.log(typeof r,`${r}`,"testing type of y ");let a=o.squares[t][r];return console.log(a,"testing board values"),{knight:function(){if(t+1<=7&&r+2<=7){const e=t+1,c=r+2;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(t+2<=7&&r+1<=7){const e=t+2,c=r+1;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(r+2<=7&&t-1>=0){const e=t-1,c=r+2;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(r+1<=7&&t-2>=0){const e=t-2,c=r+1;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(t+1<=7&&r-2>=0){const e=t+1,c=r-2;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(t+2<=7&&r-1>=0){const e=t+2,c=r-1;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(t-2>=0&&r-1>=0){const e=t-2,c=r-1;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(t-1>=0&&r-2>=0){const e=t-1,c=r-2;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}},king:function(){if(console.log("I happened 1"),a.start&&void 0!==o.squares[t+3][r]&&o.squares[t+3][r].start&&void 0===o.squares[t+1][r]&&void 0===o.squares[t+2][r]&&s.push([t+2,r]),console.log("I happened 2"),a.start&&void 0!==o.squares[t-4][r]&&o.squares[t-4][r].start&&void 0===o.squares[t-1][r]&&void 0===o.squares[t-2][r]&&void 0===o.squares[t-3][r]&&s.push([t-2,r]),console.log("I happened 3"),t+1<=7){const e=t+1,c=r;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(t+1<=7&&r+1<=7){const e=t+1,c=r+1;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(t+1<=7&&r-1>=0){const e=t+1,c=r-1;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(t-1>=0){const e=t-1,c=r;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(t-1>=0&&r+1<=7){const e=t-1,c=r+1;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(t-1>=0&&r-1>=0){const e=t-1,c=r-1;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(r+1<=7){const e=t,c=r+1;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}if(r-1>=0){const e=t,c=r-1;(void 0===o.squares[e][c]||void 0!==o.squares[e][c]&&o.squares[e][c].color!==a.color)&&s.push([e,c])}},rook:function(){let e=1;for(;t+e<=7;)void 0===o.squares[t+e][r]?(s.push([t+e,r]),e++):(a.color===o.squares[t+e][r].color||s.push([t+e,r]),e=8);for(e=1;r+e<=7;)void 0===o.squares[t][r+e]?(s.push([t,r+e]),e++):(a.color===o.squares[t][r+e].color||s.push([t,r+e]),e=8);for(e=1;t-e>=0;)void 0===o.squares[t-e][r]?(s.push([t-e,r]),e++):(a.color===o.squares[t-e][r].color||s.push([t-e,r]),e=8);for(e=1;r-e>=0;)void 0===o.squares[t][r-e]?(s.push([t,r-e]),e++):(a.color===o.squares[t][r-e].color||s.push([t,r-e]),e=8)},bishop:function(){let e=1;for(;t+e<=7&&r+e<=7;){let c=t+e,i=r+e;void 0===o.squares[c][i]?(e++,s.push([c,i])):(o.squares[c][i].color===a.color||s.push([c,i]),e=8)}for(e=1;t+e<=7&&r-e>=0;){let c=t+e,i=r-e;void 0===o.squares[c][i]?(e++,s.push([c,i])):(o.squares[c][i].color===a.color||s.push([c,i]),e=8)}for(e=1;t-e>=0&&r+e<=7;){let c=t-e,i=r+e;void 0===o.squares[c][i]?(e++,s.push([c,i])):(o.squares[c][i].color===a.color||s.push([c,i]),e=8)}for(e=1;t-e>=0&&r-e>=0;){let c=t-e,i=r-e;void 0===o.squares[c][i]?(s.push([c,i]),e++):(o.squares[c][i].color===a.color||s.push([c,i]),e=8)}},queen:function(){this.rook(),this.bishop()},pawn:function(){"white"===a.color?(console.log("I happened"),t+1<=7&&void 0!==o.squares[t+1][r]&&o.squares[t+1][r].enpasant&&o.squares[t+1][r].color!==a.color&&s.push([t+1,r+1]),console.log("I happened 2"),t-1>=0&&void 0!==o.squares[t-1][r]&&o.squares[t-1][r].enpasant&&o.squares[t-1][r].color!==a.color&&s.push([t-1,r+1]),console.log("I happened 3"),r+2<=7&&a.start&&void 0===o.squares[t][r+1]&&void 0===o.squares[t][r+2]&&s.push([t,r+2]),console.log("I happened 4"),r+1<=7&&void 0===o.squares[t][r+1]&&(s.push([t,r+1]),console.log("I happened 5")),t+1<=7&&r+1<=7&&void 0!==o.squares[t+1][r+1]&&"white"!==o.squares[t+1][r+1].color&&s.push([t+1,r+1]),console.log("I happened 6"),t-1>=0&&r+1<=7&&void 0!==o.squares[t-1][r+1]&&"white"!==o.squares[t-1][r+1].color&&s.push([t-1,r+1]),console.log("Sucess")):(console.log("I happened"),t+1<=7&&void 0!==o.squares[t+1][r]&&o.squares[t+1][r].enpasant&&o.squares[t+1][r].color!==a.color&&s.push([t+1,r-1]),console.log("I happened 2"),t-1>=0&&void 0!==o.squares[t-1][r]&&o.squares[t-1][r].enpasant&&o.squares[t-1][r].color!==a.color&&s.push([t-1,r-1]),console.log("I happened 3"),r-2>=0&&a.start&&void 0===o.squares[t][r-1]&&void 0===o.squares[t][r-2]&&s.push([t,r-2]),console.log("I happened 4"),r-1>=0&&void 0===o.squares[t][r-1]&&(s.push([t,r-1]),console.log("I happened 5")),t+1<=7&&r-1>=0&&void 0!==o.squares[t+1][r-1]&&"black"!==o.squares[t+1][r-1].color&&s.push([t+1,r-1]),console.log("I happened 6"),t-1>=0&&r-1>=0&&void 0!==o.squares[t-1][r-1]&&"black"!==o.squares[t-1][r-1].color&&s.push([t-1,r-1]),console.log("Sucess"))}}[a.type](),s},o=()=>{let o=(()=>{let e=[new Array(8),new Array(8),new Array(8),new Array(8),new Array(8),new Array(8),new Array(8),new Array(8)];return{playerFactory:e=>{const o={};return o.color=e,o.human=!1,o.king=!0,o},pieceFactory:(e,o)=>{const s={};return s.color=o,s.type=e,s.img=`../public/images/pieces/${o} ${e}.png`,s},squares:e,setPieceTo:(o,s,t,r)=>{o.start=!1,r&&(o.start=!0),e[s][t]=o}}})(),s=o.squares;const t=()=>{let e=!1;document.querySelector("#boardSquares").innerHTML="",s.forEach(((o,s)=>{let t=document.createElement("tr");t.setAttribute("class","tableRow");for(let r=0;r<=7;r++){let a=document.createElement("td");a.setAttribute("class","boardSquare"),a.setAttribute("data-coords",`${s}${r}`);let c=o[r];if(void 0!==c){let e=document.createElement("img");e.setAttribute("class","pieceImg"),e.setAttribute("src",c.img),e.setAttribute("alt",`${c.color} ${c.type}`),a.setAttribute(`data-${c.color}`,""),a.appendChild(e)}!0===e?(e=!1,a.classList.add("green")):e=!0,t.appendChild(a)}e=!0!==e,document.getElementById("boardSquares").appendChild(t)}))},r=e=>{document.querySelectorAll(`[data-${e}]`).forEach((e=>{e.addEventListener("click",a),e.classList.add("active")}))},a=s=>{l(),s.target.setAttribute("id","clickedPiece");const t=e(s.target.dataset.coords,o);c(t)},c=e=>{e.forEach((e=>{let o=document.createElement("div");o.classList.add("grey");let s=document.querySelector(`[data-coords="${e[0]}${e[1]}"]`);s.classList.add("possibleMove"),s.appendChild(o),s.addEventListener("click",i)}))},i=e=>{let a=document.querySelector("#clickedPiece"),c=parseInt(a.dataset.coords[0],10),i=parseInt(a.dataset.coords[1],10),n=parseInt(e.target.dataset.coords[0],10),d=parseInt(e.target.dataset.coords[1],10);if(console.log("I happened"),"pawn"===s[c][i].type&&(s[c][i].enpasant=!1,d-i==2||i-d==2?s[c][i].enpasant=!0:c!==n&&void 0===s[n][d]&&(s[n][i]=void 0)),"king"===s[c][i].type&&s[c][i].start&&(n-c==2?(o.setPieceTo(s[n+1][i],n-1,i),s[n+1][i]=void 0):n-c==-2&&(o.setPieceTo(s[n-2][i],n+1,i),s[n-2][i]=void 0)),o.setPieceTo(s[c][i],n,d),console.log("I happened 2"),s[c][i]=void 0,console.log("I happened 3"),l(),t(),r(s[n][d].color),7===d&&"pawn"===s[n][d].type){u("white");let e=document.querySelector(`[data-coords="${n}${d}"]`),r=document.createElement("div");r.classList.add("promoting");let a=document.createElement("img");a.setAttribute("src","../public/images/pieces/white queen.png"),a.setAttribute("alt","promote to queen"),a.addEventListener("click",(e=>{s[n][d]=o.pieceFactory("queen","white"),t()})),a.classList.add("active");let c=document.createElement("img");c.setAttribute("src","../public/images/pieces/white knight.png"),c.setAttribute("alt","promote to knight"),c.addEventListener("click",(()=>{s[n][d]=o.pieceFactory("knight","white"),t()})),c.classList.add("active");let i=document.createElement("img");i.setAttribute("src","../public/images/pieces/white rook.png"),i.setAttribute("alt","promote to rook"),i.addEventListener("click",(()=>{s[n][d]=o.pieceFactory("rook","white"),t()})),i.classList.add("active");let l=document.createElement("img");l.setAttribute("src","../public/images/pieces/white bishop.png"),l.setAttribute("alt","promote to bishop"),l.addEventListener("click",(()=>{s[n][d]=o.pieceFactory("bishop","white"),t()})),l.classList.add("active");let p=document.createElement("img");p.setAttribute("src","../public/images/pieces/white pawn.png"),p.setAttribute("alt","promote to pawn"),p.addEventListener("click",(()=>{t()})),p.classList.add("active"),r.appendChild(a),r.appendChild(c),r.appendChild(i),r.appendChild(l),r.appendChild(p),e.appendChild(r)}},l=()=>{let e=document.querySelector("#clickedPiece");null!==e&&e.removeAttribute("id"),document.querySelectorAll(".grey").forEach((e=>{let o=e.parentElement;o.classList.remove("possibleMove"),o.removeEventListener("click",i),o.removeChild(e)}))},u=e=>{document.querySelectorAll(`[data-${e}]`).forEach((e=>{console.log("item removed sucessfully"),e.removeEventListener("click",a),e.classList.remove("active")}))};return{placePieces:()=>{for(let e=0;e<=7;e++)o.setPieceTo(o.pieceFactory("pawn","white"),e,1,!0);for(let e=0;e<=7;e++)o.setPieceTo(o.pieceFactory("pawn","black"),e,6,!0);o.setPieceTo(o.pieceFactory("rook","white"),0,0,!0),o.setPieceTo(o.pieceFactory("rook","white"),7,0,!0),o.setPieceTo(o.pieceFactory("rook","black"),0,7,!0),o.setPieceTo(o.pieceFactory("rook","black"),7,7,!0),o.setPieceTo(o.pieceFactory("knight","white"),1,0),o.setPieceTo(o.pieceFactory("knight","white"),6,0),o.setPieceTo(o.pieceFactory("knight","black"),1,7),o.setPieceTo(o.pieceFactory("knight","black"),6,7),o.setPieceTo(o.pieceFactory("bishop","white"),2,0),o.setPieceTo(o.pieceFactory("bishop","white"),5,0),o.setPieceTo(o.pieceFactory("bishop","black"),2,7),o.setPieceTo(o.pieceFactory("bishop","black"),5,7),o.setPieceTo(o.pieceFactory("queen","white"),3,0),o.setPieceTo(o.pieceFactory("queen","black"),3,7),o.setPieceTo(o.pieceFactory("king","white"),4,0,!0),o.setPieceTo(o.pieceFactory("king","black"),4,7,!0)},renderBoard:t,chooseSide:e=>{let s=o.playerFactory("white"),t=o.playerFactory("black");return"1"===e?s.human=!0:t.human=!0,{player1:s,player2:t}},playerCanClick:r,game:o}};function s(e){document.querySelector(".pages .page.active").classList.remove("active"),document.querySelector(`.pages .page[data-page="${e}"]`).classList.add("active")}function t(e){let s=o();s.placePieces(),s.renderBoard(),console.log("testing gameboard 0 0 "),document.getElementById("sidechoice").classList.add("hide"),s.chooseSide(e.target.attributes.value.value).player1.human?s.playerCanClick("white"):s.playerCanClick("black")}window.onload=()=>{const e=document.querySelectorAll("[data-switcher]");for(let o=0;o<e.length;o++){const t=e[o],r=t.dataset.tab;t.addEventListener("click",(()=>{document.querySelector(".tabs .tab.active").classList.remove("active"),t.parentNode.classList.add("active"),s(r)}))}},document.getElementById("whitecolor").addEventListener("click",(e=>{t(e)})),document.getElementById("blackcolor").addEventListener("click",(e=>{t(e)}))})();