(()=>{"use strict";const e=(e,t)=>{let o=[],s=parseInt(e[0],10),c=parseInt(e[1],10);console.log(typeof s,`${s}`,"testing type of x "),console.log(typeof c,`${c}`,"testing type of y ");let r=t.squares[s][c];return console.log(r,"testing board values"),{knight:function(){if(s+1<=7&&c+2<=7){const e=s+1,a=c+2;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(s+2<=7&&c+1<=7){const e=s+2,a=c+1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(c+2<=7&&s-1>=0){const e=s-1,a=c+2;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(c+1<=7&&s-2>=0){const e=s-2,a=c+1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(s+1<=7&&c-2>=0){const e=s+1,a=c-2;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(s+2<=7&&c-1>=0){const e=s+2,a=c-1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(s-2>=0&&c-1>=0){const e=s-2,a=c-1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(s-1>=0&&c-2>=0){const e=s-1,a=c-2;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}},king:function(){if(console.log("I happened 1"),r.start&&void 0!==t.squares[s+3][c]&&t.squares[s+3][c].start&&void 0===t.squares[s+1][c]&&void 0===t.squares[s+2][c]&&o.push([s+2,c]),console.log("I happened 2"),r.start&&void 0!==t.squares[s-4][c]&&t.squares[s-4][c].start&&void 0===t.squares[s-1][c]&&void 0===t.squares[s-2][c]&&void 0===t.squares[s-3][c]&&o.push([s-2,c]),console.log("I happened 3"),s+1<=7){const e=s+1,a=c;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(s+1<=7&&c+1<=7){const e=s+1,a=c+1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(s+1<=7&&c-1>=0){const e=s+1,a=c-1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(s-1>=0){const e=s-1,a=c;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(s-1>=0&&c+1<=7){const e=s-1,a=c+1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(s-1>=0&&c-1>=0){const e=s-1,a=c-1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(c+1<=7){const e=s,a=c+1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}if(c-1>=0){const e=s,a=c-1;(void 0===t.squares[e][a]||void 0!==t.squares[e][a]&&t.squares[e][a].color!==r.color)&&o.push([e,a])}},rook:function(){let e=1;for(;s+e<=7;)void 0===t.squares[s+e][c]?(o.push([s+e,c]),e++):(r.color===t.squares[s+e][c].color||o.push([s+e,c]),e=8);for(e=1;c+e<=7;)void 0===t.squares[s][c+e]?(o.push([s,c+e]),e++):(r.color===t.squares[s][c+e].color||o.push([s,c+e]),e=8);for(e=1;s-e>=0;)void 0===t.squares[s-e][c]?(o.push([s-e,c]),e++):(r.color===t.squares[s-e][c].color||o.push([s-e,c]),e=8);for(e=1;c-e>=0;)void 0===t.squares[s][c-e]?(o.push([s,c-e]),e++):(r.color===t.squares[s][c-e].color||o.push([s,c-e]),e=8)},bishop:function(){let e=1;for(;s+e<=7&&c+e<=7;){let a=s+e,i=c+e;void 0===t.squares[a][i]?(e++,o.push([a,i])):(t.squares[a][i].color===r.color||o.push([a,i]),e=8)}for(e=1;s+e<=7&&c-e>=0;){let a=s+e,i=c-e;void 0===t.squares[a][i]?(e++,o.push([a,i])):(t.squares[a][i].color===r.color||o.push([a,i]),e=8)}for(e=1;s-e>=0&&c+e<=7;){let a=s-e,i=c+e;void 0===t.squares[a][i]?(e++,o.push([a,i])):(t.squares[a][i].color===r.color||o.push([a,i]),e=8)}for(e=1;s-e>=0&&c-e>=0;){let a=s-e,i=c-e;void 0===t.squares[a][i]?(o.push([a,i]),e++):(t.squares[a][i].color===r.color||o.push([a,i]),e=8)}},queen:function(){this.rook(),this.bishop()},pawn:function(){"white"===r.color?(console.log("I happened"),s+1<=7&&void 0!==t.squares[s+1][c]&&t.squares[s+1][c].enpasant&&t.squares[s+1][c].color!==r.color&&o.push([s+1,c+1]),console.log("I happened 2"),s-1>=0&&void 0!==t.squares[s-1][c]&&t.squares[s-1][c].enpasant&&t.squares[s-1][c].color!==r.color&&o.push([s-1,c+1]),console.log("I happened 3"),c+2<=7&&r.start&&void 0===t.squares[s][c+1]&&void 0===t.squares[s][c+2]&&o.push([s,c+2]),console.log("I happened 4"),c+1<=7&&void 0===t.squares[s][c+1]&&(o.push([s,c+1]),console.log("I happened 5")),s+1<=7&&c+1<=7&&void 0!==t.squares[s+1][c+1]&&"white"!==t.squares[s+1][c+1].color&&o.push([s+1,c+1]),console.log("I happened 6"),s-1>=0&&c+1<=7&&void 0!==t.squares[s-1][c+1]&&"white"!==t.squares[s-1][c+1].color&&o.push([s-1,c+1]),console.log("Sucess")):(console.log("I happened"),s+1<=7&&void 0!==t.squares[s+1][c]&&t.squares[s+1][c].enpasant&&t.squares[s+1][c].color!==r.color&&o.push([s+1,c-1]),console.log("I happened 2"),s-1>=0&&void 0!==t.squares[s-1][c]&&t.squares[s-1][c].enpasant&&t.squares[s-1][c].color!==r.color&&o.push([s-1,c-1]),console.log("I happened 3"),c-2>=0&&r.start&&void 0===t.squares[s][c-1]&&void 0===t.squares[s][c-2]&&o.push([s,c-2]),console.log("I happened 4"),c-1>=0&&void 0===t.squares[s][c-1]&&(o.push([s,c-1]),console.log("I happened 5")),s+1<=7&&c-1>=0&&void 0!==t.squares[s+1][c-1]&&"black"!==t.squares[s+1][c-1].color&&o.push([s+1,c-1]),console.log("I happened 6"),s-1>=0&&c-1>=0&&void 0!==t.squares[s-1][c-1]&&"black"!==t.squares[s-1][c-1].color&&o.push([s-1,c-1]),console.log("Sucess"))}}[r.type](),o},t=()=>{let t,o=(()=>{let e=[new Array(8),new Array(8),new Array(8),new Array(8),new Array(8),new Array(8),new Array(8),new Array(8)];return{playerFactory:e=>{const t={};return t.color=e,t.human=!1,t.king=!0,t},pieceFactory:(e,t)=>{const o={};return o.color=t,o.type=e,o.img=`../public/images/pieces/${t} ${e}.png`,o},squares:e,setPieceTo:(t,o,s,c)=>{t.start=!1,c&&(t.start=!0),e[o][s]=t}}})(),s=o.squares,c={};const r=()=>{let e=!1,t=document.querySelector("#boardSquares");for(;t.firstChild;)t.removeChild(t.firstChild);s.forEach(((o,s)=>{let c=document.createElement("tr");c.setAttribute("class","tableRow");for(let t=0;t<=7;t++){let r=document.createElement("td");r.setAttribute("class","boardSquare"),r.setAttribute("data-coords",`${s}${t}`);let a=o[t];if(void 0!==a){let e=document.createElement("img");e.setAttribute("class","pieceImg"),e.setAttribute("src",a.img),e.setAttribute("alt",`${a.color} ${a.type}`),r.setAttribute(`data-${a.color}`,""),r.appendChild(e)}!0===e?(e=!1,r.classList.add("green")):e=!0,c.appendChild(r)}e=!0!==e,t.appendChild(c)}))},a=e=>{"white"===e?t.player2.human?i("black"):d(void 0,g("black")):t.player1.human?i("white"):d(void 0,g("white"))},i=e=>{document.querySelectorAll(`[data-${e}]`).forEach((e=>{e.addEventListener("click",l),e.classList.add("active")}))},l=t=>{p(),t.target.setAttribute("id","clickedPiece");const s=e(t.target.dataset.coords,o);n(s)},n=e=>{e.forEach((e=>{let t=document.createElement("div");t.classList.add("grey");let o=document.querySelector(`[data-coords="${e[0]}${e[1]}"]`);o.classList.add("possibleMove"),o.appendChild(t),o.addEventListener("click",d)}))},d=(e,t)=>{let i,l,n,d,h;if(t?(i=t.start,l=parseInt(i.dataset.coords[0],10),n=parseInt(i.dataset.coords[1],10),d=t.computerEnd[0],h=t.computerEnd[1]):(i=document.querySelector("#clickedPiece"),l=parseInt(i.dataset.coords[0],10),n=parseInt(i.dataset.coords[1],10),d=parseInt(e.target.dataset.coords[0],10),h=parseInt(e.target.dataset.coords[1],10)),console.log("I happened"),console.log(l,n),"pawn"!==s[l][n].type||h-n!=2&&n-h!=2){if("pawn"===s[l][n].type&&s[d][n]===c&&void 0===s[d][h])return s[d][n]=void 0,o.setPieceTo(s[l][n],d,h),s[l][n]=void 0,p(),r(),void v(d,h);c.enpasant=!1,c=s[l][n]}else c.enpasant=!1,s[l][n].enpasant=!0,c=s[l][n];if(console.log("I happened 1 1 "),"king"===s[l][n].type&&s[l][n].start&&(d-l==2?(o.setPieceTo(s[d+1][n],d-1,n),s[d+1][n]=void 0):d-l==-2&&(o.setPieceTo(s[d-2][n],d+1,n),s[d-2][n]=void 0)),console.log("I happened 1 2 "),void 0!==s[d][h])return"king"===s[d][h].type?(o.setPieceTo(s[l][n],d,h),s[l][n]=void 0,p(),r(),void alert(`${s[d][h].color} won the game!`)):(o.setPieceTo(s[l][n],d,h),s[l][n]=void 0,p(),r(),void v(d,h,t));o.setPieceTo(s[l][n],d,h),console.log("I happened 2"),s[l][n]=void 0,console.log("I happened 3"),console.log(s[d][h]),p(),r(),"pawn"===s[d][h].type?7===h?u.white(d,h,t):0===h?u.black(d,h,t):a(s[d][h].color):a(s[d][h].color)},p=()=>{let e=document.querySelector("#clickedPiece");null!==e&&e.removeAttribute("id"),document.querySelectorAll(".grey").forEach((e=>{let t=e.parentElement;t.classList.remove("possibleMove"),t.removeEventListener("click",d),t.removeChild(e)}))},u={white:function(e,t,c){if(c)return s[e][t]=o.pieceFactory("queen","white"),r(),void a("white");let i=document.querySelector(`[data-coords="${e}${t}"]`),l=document.createElement("div");l.classList.add("promoting");let n=document.createElement("img");n.setAttribute("src","../public/images/pieces/white queen.png"),n.setAttribute("alt","promote to queen"),n.addEventListener("click",(()=>{s[e][t]=o.pieceFactory("queen","white"),r(),a("white")})),n.classList.add("active");let d=document.createElement("img");d.setAttribute("src","../public/images/pieces/white knight.png"),d.setAttribute("alt","promote to knight"),d.addEventListener("click",(()=>{s[e][t]=o.pieceFactory("knight","white"),r(),a("white")})),d.classList.add("active");let p=document.createElement("img");p.setAttribute("src","../public/images/pieces/white rook.png"),p.setAttribute("alt","promote to rook"),p.addEventListener("click",(()=>{s[e][t]=o.pieceFactory("rook","white"),r(),a("white")})),p.classList.add("active");let u=document.createElement("img");u.setAttribute("src","../public/images/pieces/white bishop.png"),u.setAttribute("alt","promote to bishop"),u.addEventListener("click",(()=>{s[e][t]=o.pieceFactory("bishop","white"),r(),a("white")})),u.classList.add("active");let h=document.createElement("img");h.setAttribute("src","../public/images/pieces/white pawn.png"),h.setAttribute("alt","promote to pawn"),h.addEventListener("click",(()=>{r(),a("white")})),h.classList.add("active"),l.appendChild(n),l.appendChild(d),l.appendChild(p),l.appendChild(u),l.appendChild(h),i.appendChild(l)},black:function(e,t,c){if(c)return s[e][t]=o.pieceFactory("queen","black"),r(),void a("black");let i=document.querySelector(`[data-coords="${e}${t}"]`),l=document.createElement("div");l.classList.add("promoting");let n=document.createElement("img");n.setAttribute("src","../public/images/pieces/black queen.png"),n.setAttribute("alt","promote to queen"),n.addEventListener("click",(()=>{s[e][t]=o.pieceFactory("queen","black"),r(),a("black")})),n.classList.add("active");let d=document.createElement("img");d.setAttribute("src","../public/images/pieces/black knight.png"),d.setAttribute("alt","promote to knight"),d.addEventListener("click",(()=>{s[e][t]=o.pieceFactory("knight","black"),r(),a("black")})),d.classList.add("active");let p=document.createElement("img");p.setAttribute("src","../public/images/pieces/black rook.png"),p.setAttribute("alt","promote to rook"),p.addEventListener("click",(()=>{s[e][t]=o.pieceFactory("rook","black"),r(),a("black")})),p.classList.add("active");let u=document.createElement("img");u.setAttribute("src","../public/images/pieces/black bishop.png"),u.setAttribute("alt","promote to bishop"),u.addEventListener("click",(()=>{s[e][t]=o.pieceFactory("bishop","black"),r(),a("black")})),u.classList.add("active");let h=document.createElement("img");h.setAttribute("src","../public/images/pieces/black pawn.png"),h.setAttribute("alt","promote to pawn"),h.addEventListener("click",(()=>{r(),a("black")})),h.classList.add("active"),l.appendChild(n),l.appendChild(d),l.appendChild(p),l.appendChild(u),l.appendChild(h),i.appendChild(l)}},h=e=>{console.log("Im getting to explode");let t=e.target.parentElement.parentElement.dataset.coords,o=parseInt(t[0],10),c=parseInt(t[1],10),i=s[o][c].color,l=!1;if("king"===s[o][c].type&&(l=s[o][c]),console.log("im getting to here"),s[o][c]=void 0,c+1<=7&&void 0!==s[o][c+1]&&("king"===s[o][c+1].type&&("king"===s[o][c+1].type&&(l=s[o][c+1].color),s[o][c+1]=void 0),s[o][c+1]=void 0),c-1>=0&&void 0!==s[o][c-1]&&("king"===s[o][c-1].type&&(l=s[o][c-1].color),s[o][c-1]=void 0),o+1<=7&&c+1<=7&&void 0!==s[o+1][c+1]&&("king"===s[o+1][c+1].type&&(l=s[o+1][c+1].color),s[o+1][c+1]=void 0),o+1<=7&&void 0!==s[o+1][c]&&("king"===s[o+1][c].type&&(l=s[o+1][c].color),s[o+1][c]=void 0),o+1<=7&&c-1>=0&&void 0!==s[o+1][c-1]&&("king"===s[o+1][c-1].type&&(l=s[o+1][c-1].color),s[o+1][c-1]=void 0),o-1>=0&&c+1<=7&&void 0!==s[o-1][c+1]&&("king"===s[o-1][c+1].type&&(l=s[o-1][c+1].color),s[o-1][c+1]=void 0),o-1>=0&&void 0!==s[o-1][c]&&("king"===s[o-1][c].type&&(l=s[o-1][c].color),s[o-1][c]=void 0),o-1>=0&&c-1>=0&&void 0!==s[o-1][c-1]&&("king"===s[o-1][c-1].type&&(l=s[o-1][c-1].color),s[o-1][c-1]=void 0),l)return alert(`${l} has lost`),void r();p(),r(),a(i)},v=(e,t,o)=>{let c=document.querySelector(`[data-coords='${e}${t}']`),i=document.createElement("div");i.classList.add("attackChoice");let l=document.createElement("p");l.textContent="Normal attack",l.addEventListener("click",(()=>{p(),r(),"pawn"===s[e][t].type?7===t?u.white(e,t,o):0===t?u.black(e,t,o):a(s[e][t].color):a(s[e][t].color)}));let n=document.createElement("p");n.textContent="Explode",n.addEventListener("click",h),i.appendChild(l),i.appendChild(n),c.appendChild(i)},g=t=>{let s=document.querySelectorAll(`[data-${t}]`),c=0,r=[];for(;0===r.length&&c<s.length;)console.log(s[c].dataset.coords,"im the coords of computer"),r=e(s[c].dataset.coords,o),c++;let a=s[c-1],i=r[0];return console.log(i,"Im found a move"),console.log(a,"Im the start piece"),{start:a,computerEnd:i}};return{placePieces:()=>{for(let e=0;e<=7;e++)o.setPieceTo(o.pieceFactory("pawn","white"),e,1,!0);for(let e=0;e<=7;e++)o.setPieceTo(o.pieceFactory("pawn","black"),e,6,!0);o.setPieceTo(o.pieceFactory("rook","white"),0,0,!0),o.setPieceTo(o.pieceFactory("rook","white"),7,0,!0),o.setPieceTo(o.pieceFactory("rook","black"),0,7,!0),o.setPieceTo(o.pieceFactory("rook","black"),7,7,!0),o.setPieceTo(o.pieceFactory("knight","white"),1,0),o.setPieceTo(o.pieceFactory("knight","white"),6,0),o.setPieceTo(o.pieceFactory("knight","black"),1,7),o.setPieceTo(o.pieceFactory("knight","black"),6,7),o.setPieceTo(o.pieceFactory("bishop","white"),2,0),o.setPieceTo(o.pieceFactory("bishop","white"),5,0),o.setPieceTo(o.pieceFactory("bishop","black"),2,7),o.setPieceTo(o.pieceFactory("bishop","black"),5,7),o.setPieceTo(o.pieceFactory("queen","white"),3,0),o.setPieceTo(o.pieceFactory("queen","black"),3,7),o.setPieceTo(o.pieceFactory("king","white"),4,0,!0),o.setPieceTo(o.pieceFactory("king","black"),4,7,!0)},renderBoard:r,chooseSide:e=>{let s=o.playerFactory("white"),c=o.playerFactory("black");return"1"===e?s.human=!0:c.human=!0,t={player1:s,player2:c},t},playerCanClick:i,game:o,play:d,computerAttack:g}};function o(e){document.querySelector(".pages .page.active").classList.remove("active"),document.querySelector(`.pages .page[data-page="${e}"]`).classList.add("active")}function s(e){let o=t();o.placePieces(),o.renderBoard(),console.log("testing gameboard 0 0 "),document.getElementById("sidechoice").classList.add("hide"),o.chooseSide(e.target.attributes.value.value).player1.human?o.playerCanClick("white"):o.play(void 0,o.computerAttack("white"))}window.onload=()=>{const e=document.querySelectorAll("[data-switcher]");for(let t=0;t<e.length;t++){const s=e[t],c=s.dataset.tab;s.addEventListener("click",(()=>{document.querySelector(".tabs .tab.active").classList.remove("active"),s.parentNode.classList.add("active"),o(c)}))}},document.getElementById("whitecolor").addEventListener("click",(e=>{s(e)})),document.getElementById("blackcolor").addEventListener("click",(e=>{s(e)}))})();